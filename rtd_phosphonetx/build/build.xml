<project name="rtd_phosphonetx" default="ci" basedir="..">
	<import file="../../openbis/build/build.xml" />
	<import file="../../datastore_server/build/build.xml" />
	<project-classpath name="ecp" classes="${classes}" />

	<property name="original.dist" value="dist" />
	<property name="mainfolder" value="rtd_phosphonetx" />
	<property name="variant" value="-phosphonetx"/>

	<target name="compile" depends="build-common.compile, clean" />

	<target name="run-tests">
		<copy todir="${classes}">
			<fileset dir="${sources}">
				<include name="**/*.xsd" />
			</fileset>
		</copy>
		<antcall target="build-common.run-tests">
			<param name="test.suite" value="tests.xml" />
		</antcall>
	</target>

        <!--
        // Task for creating distributions
        -->
        <target name="dist" depends="openbis.make-dist, datastore_server.make-dist"/>
	
        <!--
        // Task for continuous integration server.
        -->
        <target name="ci" depends="build-common.ci, dist, check-dependencies"/>
	
        <!--
        // Compiles the javascript using GWT compiler.
        -->
        <target name="compile-javascript"
                depends="prepare-web-client"
                description="Compiles the javascript using GWT compiler.">
                <antcall target="compile-gwt-module">
                        <param name="gwt.module.name" value="ch.systemsx.cisd.openbis.plugin.phosphonetx.OpenBIS" />
                </antcall>
        </target>

        <!--
        // Creates WAR file.
        -->
        <target name="war" depends="openbis.war" description="Creates project war file.">
        	<war warfile="${webapp.file}" update="true">
                        <classes prefix="WEB-INF/classes/phosphonetx" dir="source">
                                <include name="**/*.sql" />
                        </classes>
                        <classes dir="../openbis/${sources}">
                                <include name="**/*.xml" />
                                <exclude name="**/*.gwt.xml" />
                        </classes>
                        <lib dir="${lib}/jaxb">
                                <include name="*.jar" />
                        </lib>
                        <lib dir="${lib}/eodsql">
                                <include name="*.jar" />
                        </lib>
        	</war>
        </target>
</project>